<!DOCTYPE html>  
<html lang="en">  
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>  
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.0/css/bootstrap-combined.min.css" rel="stylesheet">
		<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.0/js/bootstrap.min.js"></script>
		<script>  
			function geo_error(error) {  
				switch(error.code) {  
					case error.PERMISSION_DENIED: 
						alert('user did not share geolocation data');  
						break;  
					case error.POSITION_UNAVAILABLE: 
						alert('could not detect current position');  
						break;  
					case error.TIMEOUT: 
						alert('retrieving position timed out');  
						break;  
					default: 
						alert('unknown error');  
						break;  
				}  
			} 

			function geo_success(position){
				$.ajax({
					url: '/y',
					data: { lat: position.coords.latitude, lon: position.coords.longitude },
				}).done(function(json) {
					var obj = JSON.parse(json);
					if (obj.status) {
						var coffee = obj.coffee;
						var location = coffee.location;
						$('#coffee')
							.text('Go to ')
							.append('<strong><a href="' + coffee.url + '">' + coffee.name + '</a></strong>. ')
							.append('<br/>')
							.append("<h4>It's by " + location.cross_streets + '.</h4>');
					} else {
						$('#coffee').text("... hell, I don't know.");
					}
				});
			}

			$(document).ready(function(){  
				navigator.geolocation.getCurrentPosition(geo_success, geo_error);
			});  
		</script>  
	</head>  
	<body>
		<div class="container" style="text-align: center;">
			<h1>Need some good fucking coffee?<br/><br/></h1>
			<h1><span id="coffee">...</span></h1>
		</div>	
	</body>  
</html>  